<template>
  <require from="./list.css"></require>
  <div class="shop-products-list">
    <section class="shop-products-list__filter">
      <div class="shop-products-list__filter__search">
        <form submit.delegate="resetPageAndFetch()">
          <input placeholder="Search Products" value.bind="products.params.filter['tsv:search']">
        </form>
      </div>
      <div class="shop-products-list__filter__category">
        <label>Category</label>
        <select value.bind="products.params.filter['category_id:eq']" change.delegate="resetPageAndFetch()">
          <option model.bind="null">Choose</option>
          <option repeat.for="category of categories.data" model.bind="category.id">${category.name}</option>
        </select>
      </div>
      <div class="shop-products-list__filter__source">
        <label>Country</label>
        <select value.bind="products.params.filter['source_id:eq']" change.delegate="resetPageAndFetch()">
          <option model.bind="null">Choose</option>
          <option repeat.for="country of countries.data" model.bind="country.id">${country.name}</option>
        </select>
      </div>
      <div class="shop-products-list__filter__source">
        <label>Requires Price Breakdown</label>
        <input type="checkbox" checked.bind="products.params.filter['cost:isNull']" change.delegate="resetPageAndFetch()"/>
      </div>
      <div class="shop-products-list__filter__create">
        <a href.bind="'user/shops/' + shop.data.id + '/products/create'">
          <i class="icon ion-plus"></i>
          Create
        </a>
      </div>
    </section>
    <section>
      <table>
        <tr>
          <th>Name</th>
          <th>Novelship URL</th>
          <th>Store URL</th>
          <th>Price</th>
        </tr>
        <tr repeat.for="product of products.data">
          <td>
            <a href.bind="'user/shops/' + shop.data.id + '/products/' + product.id + '/edit'" >${product.name}</a>
          </td>
          <td><a href="${'products/' + product.id}" target="_blank">novelship link</a></td>
          <td><a href.bind="product.url" target="_blank">link</a></td>
          <td>${product.price | toCurrency}</td>
        </tr>
      </table>
    <div>
      <pagination size.bind="products.params.page.size" total.bind="products.total" path.bind="path" params.bind="query"></pagination>
    </div>
    </section>
  </div>
</template>
