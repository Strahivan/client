<template>
  <require from="./custom-checkout.css"></require>
  <div class="custom-checkout modal active">
    <div class="modal-overlay"></div>
    <div class="cc-container modal-container">
      <section class="cc__order-info">
        <div>
          <a href.bind="request.product_details.url" target="_blank">${request.product_details.name || 'Custom Product'}</a>
        </div>
        <div>
          ${request.instructions}
        </div>
        <div>
          ${request.count}
        </div>
        <div>
          ${request.delivery_date | toDate:'date'}
        </div>
      </section>
      <section>
        <div>
          ${request.total_price | toCurrency}
        </div>
      </section>
      <section>
        <div if.bind="request.collection_method === 'courier'" class="shipping-address">
          <label>Address</label>
          Line 1
          <input value.bind="request.shipping_address.line_1" type="text" />
          Line 2
          <input value.bind="request.shipping_address.line_2" type="text" />
          City
          <input value.bind="request.shipping_address.city" type="text" />
          Zip
          <input value.bind="request.shipping_address.zip" type="text" />
        </div>
      </section>
      <section class="cc__card-payment">
        <div class="cc__card-payment__button" click.trigger="togglePaymentView('card-payment')">
          <i show.bind="currentPaymentMethod !== 'card-payment'" class="icon ion-arrow-right-b"></i>
          <i show.bind="currentPaymentMethod === 'card-payment'" class="icon ion-arrow-down-b"></i>
          <i class="icon ion-card"></i>
          Card Payment
        </div>
        <div show.bind="currentPaymentMethod === 'card-payment'" class="cc__card-payment__content">
          <div if.bind="cards.length && !state.addcard">
            <label>
              Pay using:
              <select value.bind="selectedCard">
                <option repeat.for="card of cards" model.bind="card.id">${card.brand} ending with ${card.last4}</option>
              </select>
            </label>
            <button click.delegate="charge()">Pay $${request.total_price | toCurrency}</button>
            <button if.bind="!state.addcard" click.delegate="state.addcard = true">Add New Card</button>
          </div>
          <div class="cc__card-payment__content__add" if.bind="state.addcard || !cards.length">
            <payment-form save.call="charge(token)" button-text="Pay"></payment-form>
            <a href="#" if.bind="cards.length" click.delegate="state.addcard = false">Cancel</a>
          </div>
        </div>
      </section>
      <section class="cc__bank-payment">
        <div class="cc__bank-payment__button" click.trigger="togglePaymentView('bank-payment')">
          <i show.bind="currentPaymentMethod !== 'bank-payment'" class="icon ion-arrow-right-b"></i>
          <i show.bind="currentPaymentMethod === 'bank-payment'" class="icon ion-arrow-down-b"></i>
          <i class="icon ion-cash"></i>
          Bank Payment
        </div>
        <div class="cc__bank-payment__content" show.bind="currentPaymentMethod === 'bank-payment'">
          <ol class="cc__bank-payment__content__instructions">
            <li class="cc__bank-payment__content__instructions__step">
              <i class="icon ion-checkmark-circled"></i>
              Log in to internet banking
            </li>
            <li class="cc__bank-payment__content__instructions__step">
              <i class="icon ion-checkmark-circled"></i>
              Add new Payee:
              <div class="cc__bank-payment__content__instructions__step__account">
                <label>DBS Business Banking</label>
                <div>
                  <label>Account Name:</label>
                  AthenaDesk Pte Ltd
                </div>
                <div>
                  <label>Account No:</label>
                  003-949373-8
                </div>
                <div>
                  <label>Branch Code:</label>
                  003
                </div>
              </div>
            </li>
            <li class="cc__bank-payment__content__instructions__step">
              <i class="icon ion-checkmark-circled"></i>
              Transfer ${request.currency} ${request.total_price | toCurrency} to the account
            </li>
            <li class="cc__bank-payment__content__instructions__step">
              <i class="icon ion-checkmark-circled"></i>
              For Internet Banking, please put your full name into "Your Initials"
            </li>
            <li class="cc__bank-payment__content__instructions__step">
              <i class="icon ion-checkmark-circled"></i>
              Take a picture of the reciept and submit the photo as proof
            </li>
          </ol>
          <div class="cc__bank-payment__ref">
            <input type="file" files.bind="proof | toArray">
            <button click.delegate="saveProof()">Submit Proof</button>
          </div>
        </div>
      </section>
      <section class="modal-footer">
        <button click.delegate="controller.cancel()">Cancel</button>
      </section>
    </div>
    <div if.bind="state.inflight" class="cc__loading">
      Processing. Please do not navigate away from this page.
      <div class="sk-wandering-cubes">
        <div class="sk-cube sk-cube1"></div>
        <div class="sk-cube sk-cube2"></div>
      </div>
    </div>
  </div>
</template>
